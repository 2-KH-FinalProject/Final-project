<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org">

<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>티켓팅 시스템</title>
	<th:block th:replace="~{common/common}"></th:block>

	<link rel="stylesheet" href="/css/performance/genre.css">

</head>

<body>
	<th:block th:replace="~{common/header}"></th:block>

	<div class="parent">
		<h3 th:text="${genre}">장르</h3>
	</div>
	
	<!-- 탭 버튼 추가 -->
	<div class="tab-container">
	    <div class="tab-buttons">
	        <button class="tab-button active" data-filter="all">전체</button>
	        <button class="tab-button" data-filter="rating">평점순</button>
	        <button class="tab-button" data-filter="upcoming">공연예정</button>
	        <button class="tab-button" data-filter="ongoing">공연중</button>
	    </div>
	</div>

	<div class="performance-container">
		<div class="performance-grid" id="performanceGrid">
			<th:block th:each="performance : ${performances}">
				<div class="performance-item"
					th:onclick="|location.href='@{/performance/detail/{mt20id}(mt20id=${performance.mt20id})}'|">
					<div class="image-container">
						<img th:src="${performance.poster}" th:alt="${performance.prfnm}" class="performance-image"
							loading="lazy" decoding="async">
					</div>
					<div class="performance-info">
						<div class="performance-title" th:text="${performance.prfnm}">공연 제목</div>
						<div class="performance-date">
							<span th:text="${performance.prfpdfrom}">시작일</span> ~
							<span th:text="${performance.prfpdto}">종료일</span>
						</div>
						<div class="performance-venue" th:text="${performance.fcltynm}">공연장</div>
					</div>
				</div>
			</th:block>
		</div>
		<div class="loading-spinner" style="display: none;">
			Loading...
		</div>
	</div>

	<th:block th:replace="~{common/footer}"></th:block>

	<script th:inline="javascript">
		let page = 1;
		let isLoading = false;
		let hasMoreData = true;
		const genre = /*[[${genre}]]*/ null;
		const imageCache = new Map();
		
		// 현재 선택된 필터를 저장할 변수
		let currentFilter = 'all';
		
	</script>
	
	<script src="/js/performance/genre.js"></script>
</body>

</html>